if("undefined"==typeof jQuery)throw new Error("MultiTabs requires jQuery");!function(a){"use strict";var c,d,b=".multitabs",f=function(a,c,d,e,f){var g=f?c:c.split(" ").join(b+" ")+b;"string"!=typeof d&&(e=e||d,d=""),a.off(g,d,e).on(g,d,e)},g=function(a,b){return"main"===a||"editor"===a?0:(b=b||8,c=c||0,c++,c%=b)},l=function(b,c){var d,e,f,g;for(c=c||t.maxTitleLength,d=String(b).split(" "),e="",f=0;f<d.length;f++)g=a.trim(d[f]),e+=g?g+" ":"";return e.length>c&&(e=e.substr(0,c),e+="..."),e},o=function(){return!(void 0===sessionStorage)},k=function(b){var c=0;return a(b).each(function(){c+=a(this).outerWidth(!0)}),c},j=function(a){var b=function(a){var b=document.createElement("a");return b.href=a,b.href}(a),c=window.location.protocol+"//"+window.location.host+"/",d=b.substr(0,c.length);return!(d===c)},n=function(a){for(var b in a)return!1;return!0},h=function(a){return a.replace(/\./g,"").replace(/([A-Z])/g,"-$1").toLowerCase()},p={"default":'<div class="mt-wrapper {mainClass}" style="height: 100%;" >   <div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};">       <div class="mt-nav mt-nav-tools-left">           <ul  class="nav {nav-tabs}">               <li class="mt-move-left"><a><i class="fa fa-backward"></i></a></li>           </ul>       </div>       <nav class="mt-nav mt-nav-panel">           <ul  class="nav {nav-tabs}">               <li><a data-id="multitabs_main_0" class="mt-nav-tab" data-content="main" data-index="0" data-url="welcome_to_use_multitabs"> Home </a></li>           </ul>       </nav>       <div class="mt-nav mt-nav-tools-right">           <ul  class="nav {nav-tabs}">               <li class="mt-move-right"><a><i class="fa fa-forward"></i></a></li>               <li class="mt-dropdown dropdown">                   <a href="#"  class="dropdown-toggle" data-toggle="dropdown">{dropdown}<span class="caret"></span></a>                   <ul role="menu" class="dropdown-menu dropdown-menu-right">                       <li class="mt-show-actived-tab"><a>{showActivedTab}</a></li>                       <li class="divider"></li>                       <li class="mt-close-all-tabs"><a>{closeAllTabs}</a></li>                       <li class="mt-close-other-tabs"><a>{closeOtherTabs}</a></li>                   </ul>               </li>           </ul>       </div>   </div>   <div class="tab-content mt-tab-content " >       <div id="multitabs_main_0" class="tab-pane active"  data-content="main" data-index="0" data-url="welcome_to_use_multitabs"><h1>Demo page</h1><h2>Welcome to use bootstrap multi-tabs :) </h2></div>   </div></div>',classic:'<div class="mt-wrapper {mainClass}" style="height: 100%;" >   <div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};">       <nav class="mt-nav mt-nav-panel">           <ul  class="nav {nav-tabs}">               <li><a data-id="multitabs_main_0" class="mt-nav-tab" data-content="main" data-index="0" data-url="welcome_to_use_multitabs"> Home </a></li>           </ul>       </nav>       <div class="mt-nav mt-nav-tools-right">           <ul  class="nav {nav-tabs}">               <li class="mt-dropdown dropdown">                   <a href="#"  class="dropdown-toggle" data-toggle="dropdown">{dropdown}<span class="caret"></span></a>                   <ul role="menu" class="mt-hidden-list dropdown-menu dropdown-menu-right"></ul>               </li>           </ul>       </div>   </div>   <div class="tab-content mt-tab-content " >       <div id="multitabs_main_0" class="tab-pane active"  data-content="main" data-index="0" data-url="welcome_to_use_multitabs"><h1>Demo page</h1><h2>Welcome to use bootstrap multi-tabs :) </h2></div>   </div></div>',simple:'<div class="mt-wrapper {mainClass}" style="height: 100%;" >   <div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};">       <nav class="mt-nav mt-nav-panel">           <ul  class="nav {nav-tabs}">               <li><a data-id="multitabs_main_0" class="mt-nav-tab" data-content="main" data-index="0" data-url="welcome_to_use_multitabs"> Home </a></li>           </ul>       </nav>   </div>   <div class="tab-content mt-tab-content " >       <div id="multitabs_main_0" class="tab-pane active"  data-content="main" data-index="0" data-url="welcome_to_use_multitabs"><h1>Demo page</h1><h2>Welcome to use bootstrap multi-tabs :) </h2></div>   </div></div>',navTab:'<a data-id="{navTabId}" class="mt-nav-tab" data-content="{content}" data-index="{index}" data-url="{url}">{title}</a>',closeBtn:' <i class="mt-close-tab fa fa-times" style="{style}"></i>',ajaxTabPane:'<div id="{tabPaneId}" class="tab-pane {class}"></div>',iframeTabPane:'<iframe id="{tabPaneId}" class="tab-pane {class}"  width="100%" height="100%" frameborder="0" src="" seamless></iframe>'},q={navBar:{title:"Tab",dropdown:'<i class="fa fa-bars"></i>',showActivedTab:"Show Activated Tab",closeAllTabs:"Close All Tabs",closeOtherTabs:"Close Other Tabs"},editorUnsave:{colse:"Your data is not save, are you sure to lose it?",cover:"Can not cover Editor without saving the old one!"}},t={"class":"",maxTabs:15,maxTitleLength:25,backgroundColor:"#f5f5f5"},r={"class":""},s={"class":"",otherHeight:0},e=function(b,c){var d=this;d.$element=a(b),d._validate()&&d._init(c)._listen()._final()};e.prototype={constructor:e,create:function(a,b){var h,i,j,k,l,m,n,o,q,r,c=this,d=c.options,e=c.$element,f=e.tabContent.find('.tab-pane[data-content="editor"]');return(h=c._getParam(a))?(o=c._exist(h))?(c.active(o),c):(h.active=void 0===h.active?b:h.active,"editor"===h.content&&f.length&&f.hasClass("unsave")?(o=e.navPanelList.find('a[data-content="editor"]'),c.active(o),q=c._getTabPane(o),q.before('<div class="help-block alert alert-warning">'+d.language.editorUnsave.cover+"</div>"),c):(m=g(h.content,d.navBar.maxTabs),n="multitabs_"+h.content+"_"+m,k=d.showClose?"display:inline;":"",j="main"===h.content?"":p.closeBtn.replace("{style}",k),i=p.navTab.replace("{navTabId}",n).replace("{content}",h.content).replace("{index}",m).replace("{url}",h.url).replace("{title}",h.title)+j,r=e.navPanelList.find('a[data-content="'+h.content+'"][data-index="'+m+'"]').parent("li"),r.length?(r.html(i),c._getTabPane(r.find("a:first")).remove()):e.navPanelList.append("<li>"+i+"</li>"),o=e.navPanelList.find('a[data-id="'+n+'"]'),l=h.iframe?p.iframeTabPane.replace("{class}",d.iframeTabPane.class).replace("{tabPaneId}",n):p.ajaxTabPane.replace("{class}",d.ajaxTabPane.class).replace("{tabPaneId}",n),e.tabContent.append(l),c._storage(n,h),h.active&&c.active(o),c)):c},active:function(b){var i,k,m,c=this,e=c.$element,f=c.options,g=c._getNavTab(b),h=g.parent("li"),j=e.navPanelList.find("li.active:first").find("a:first");return b&&h.length?(k=g.attr("data-url"),g.attr("data-content"),m=c._getTabPane(g),m.length?(i=c._storage(),i[j.attr("id")]&&(i[j.attr("id")].active=!1),i[g.attr("id")]&&(i[g.attr("id")].active=!0),c._resetStorage(i),j.closest("li").removeClass("active"),h.addClass("active"),c._fixTabPosition(g),c._getTabPane(j).removeClass("active"),m.addClass("active"),c._fixTabContentLayout(m),m.html()||(m.is("iframe")?m.attr("src")||m.attr("src",k):a.ajax({url:k,dataType:"html",success:function(a){m.html(f.ajaxSuccess(a))},error:function(a){m.html(f.ajaxError(a))}})),f.showHash&&k&&(d=!0,window.location.hash="#"+k),c):c):c},moveLeft:function(){var h,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=k(b.navPanelList.children("li")),f=0,g=0;if(d>e)return a;for(h=b.navPanelList.children("li:first");g+h.width()<=c;)g+=h.outerWidth(!0),h=h.next();if(g=0,k(h.prevAll())>d){for(;g+h.width()<d&&h.length>0;)g+=h.outerWidth(!0),h=h.prev();f=k(h.prevAll())}return b.navPanelList.animate({marginLeft:0-f+"px"},"fast"),a},moveRight:function(){var g,h,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=k(b.navPanelList.children("li")),f=0;if(d>e)return a;for(g=b.navPanelList.children("li:first"),h=0;h+g.width()<=c;)h+=g.outerWidth(!0),g=g.next();for(h=0;h+g.width()<d&&g.length>0;)h+=g.outerWidth(!0),g=g.next();return f=k(g.prevAll()),f>0&&b.navPanelList.animate({marginLeft:0-f+"px"},"fast"),a},close:function(a){var f,g,b=this,d=b._getNavTab(a),e=d.parent("li"),c=b._getTabPane(d);return e.length&&c.length&&"editor"===d.attr("data-content")&&c.hasClass("unsave")&&!b._unsaveConfirm()?b:(e.hasClass("active")&&(f=e.next("li:first"),g=e.prev("li:last"),f.size()?b.active(f):g.size()&&b.active(g)),b._delStorage(d.attr("id")),e.remove(),c.remove(),b)},closeOthers:function(){var b=this,c=b.$element;return c.navPanelList.find("li:not(.active)").find('a:not([data-content="main"]):not([data-content="editor"])').each(function(){var c=a(this);b._delStorage(c.attr("id")),b._getTabPane(c).remove(),c.parent("li").remove()}),c.navPanelList.css("margin-left","0"),b},showActive:function(){var a=this,b=a.$element,c=b.navPanelList.find("li.active:first a");return a._fixTabPosition(c),a},closeAll:function(){var b=this,c=b.$element;return c.navPanelList.find('a:not([data-content="main"]):not([data-content="editor"])').each(function(){var c=a(this);b._delStorage(c.attr("id")),b._getTabPane(c).remove(),c.parent("li").remove()}),b.active(c.navPanelList.find('a[data-content="main"]:first').parent("li")),b},_init:function(b){var e,c=this,d=c.$element;return d.html(p[b.layout].replace("{mainClass}",h(b.class)).replace("{navBarClass}",b.navBar.class).replace(/\{nav-tabs\}/g,b.style).replace(/\{backgroundColor\}/g,b.navBar.backgroundColor).replace("{dropdown}",b.language.navBar.dropdown).replace("{showActivedTab}",b.language.navBar.showActivedTab).replace("{closeAllTabs}",b.language.navBar.closeAllTabs).replace("{closeOtherTabs}",b.language.navBar.closeOtherTabs)),d.wrapper=d.find(".mt-wrapper:first"),d.navBar=d.find(".mt-nav-bar:first"),d.navToolsLeft=d.navBar.find(".mt-nav-tools-left:first"),d.navPanel=d.navBar.find(".mt-nav-panel:first"),d.navPanelList=d.navBar.find(".mt-nav-panel:first ul"),d.navTabMain=a("#multitabs_main_0"),d.navToolsRight=d.navBar.find(".mt-nav-tools-right:first"),d.tabContent=d.find(".tab-content:first"),b.navBar.maxTabs<=1&&(b.navBar.maxTabs=1,d.navBar.hide()),e=d.navBar.find(".mt-nav-tools-left:visible:first").width()+d.navBar.find(".mt-nav-tools-right:visible:first").width(),d.navPanel.css("width","calc(100% - "+e+"px)"),c.options=b,c},_final:function(){var e,g,h,b=this,c=b.$element,d=b.options,f=d.init;if(o&&(e=b._storage(),a.each(e,function(a,c){b.create(c,!1)})),n(e))for(f=f instanceof Array?f:[],h=0;h<f.length;h++)g=b._getParam(f[h]),g&&b.create(g);return c.navPanelList.children("li.active").length||window.location.hash.substr(1)||b.active(c.navPanelList.find('[data-content="main"]:first')),b},_validate:function(){var c,b=this;return n(a(document).data("multitabs"))?!0:(c='<div class="help-block alert alert-warning"><h4>Duplicate Instance</h4>MultiTabs only can be 1 Instance.</div>',b.$element.before(c),!1)},_listen:function(){var g,b=this,c=b.$element,e=b.options;return f(a(document),"click",e.link,function(){return b.create(this,!0),!1}),f(c.navBar,"click",".mt-nav-tab",function(){b.active(this)}),f(c.navPanelList,"mousedown",'.mt-nav-tab:not([data-content="main"])',function(b){var d=a(this).closest("li"),e=d.prev(),f=!0,g=!1,h='<li id="multitabs_tmp_tab_blank" class="mt-tmp" style="width:'+d.outerWidth()+"px; height:"+d.outerHeight()+'px;"><a style="width: 100%;  height: 100%; "></a></li>',i=b.pageX-d.offset().left+c.navBar.offset().left;d.prev().after(h),d.css({left:b.pageX-i+"px",position:"absolute","z-index":9999}).addClass("mt-tmp").find("a:first").css({background:"#f39c12"}),a(document).on("mousemove",function(b){f&&(d.css({left:b.pageX-i+"px"}),c.navPanelList.children('li:not(".mt-tmp")').each(function(){var b=a(this).offset().left+a(this).outerWidth()+20;return b>d.offset().left?("multitabs_tmp_tab_blank"!=a(this).next().attr("id")&&(g=!0,e=a(this),a("#multitabs_tmp_tab_blank").remove(),e.after(h)),!1):void 0}))}).on("selectstart",function(){return f?!1:void 0}).on("mouseup",function(){f&&(d.css({left:"0px",position:"relative","z-index":"inherit"}).removeClass("mt-tmp").find("a:first").css({background:""}),a("#multitabs_tmp_tab_blank").remove(),g&&e.after(d)),f=!1})}),f(c.navBar,"click",".mt-close-tab",function(){return b.close(a(this).closest("li")),!1}),f(c.navBar,"click",".mt-move-left",function(){return b.moveLeft(),!1}),f(c.navBar,"click",".mt-move-right",function(){return b.moveRight(),!1}),f(c.navBar,"click",".mt-show-actived-tab",function(){return b.showActive(),!1}),f(c.navBar,"click",".mt-close-all-tabs",function(){return b.closeAll(),!1}),f(c.navBar,"click",".mt-close-other-tabs",function(){return b.closeOthers(),!1}),f(a(window),"beforeunload",function(){return c.tabContent.find('.tab-pane[data-content="editor"]').hasClass("unsave")?e.language.editorUnsave.close:void 0}),g=c.navBar.outerHeight(),c.tabContent.css("paddingTop",g),e.fixed&&f(a(window),"scroll",function(){var b=a(this).scrollTop();return b=b<c.wrapper.height()-g?b+"px":"auto",c.navBar.css("top",b),!1}),e.showHash&&f(a(window),"hashchange load",function(){if(!d){var a,e,f,g,h;return(a=window.location.hash)?(e=a.replace("#",""),g=c.navPanelList.find('[data-url="'+e+'"]:first'),g.length?(f=g.parent("li"),f.hasClass("active")||b.active(f),!1):(h=document.createElement("a"),h.href=e,b.create(h,!0),!1)):!1}return d=!1,!1}),"classic"===e.layout&&f(c.navBar,"click",".mt-dropdown:not(.open)",function(){var a=b._getHiddenList(),d=c.navToolsRight.find(".mt-hidden-list:first").empty();if(a){for(;a.prevList.length;)d.append(a.prevList.shift().clone());for(;a.nextList.length;)d.append(a.nextList.shift().clone())}else d.append("<li>empty</li>")}),b},_getParam:function(b){if(n(b))return!1;var e,c=this,d=c.options,f=a(b),g=f.data();return e=n(g)?{}:g,e.url=e.url||b.url||f.attr("href")||f.attr("url"),e.url=a.trim(decodeURIComponent(e.url.replace("#",""))),e.url.length?(e.iframe=e.iframe||b.iframe||j(e.url)||d.iframe,e.content=e.content||b.content||d.content,e.title=e.title||b.title||f.text()||e.url.replace("http://","").replace("https://","")||d.language.navBar.title,e.title=l(e.title,d.navBar.maxTitleLength),e.active=e.active||b.active,e):!1},_storage:function(a,b){if(o()){var c=JSON.parse(sessionStorage.multitabs||"{}");return a?b?(c[a]=b,sessionStorage.multitabs=JSON.stringify(c),c):c[a]:c}},_delStorage:function(a){if(o()){var b=JSON.parse(sessionStorage.multitabs||"{}");return a?(delete b[a],sessionStorage.multitabs=JSON.stringify(b),b):b}},_resetStorage:function(a){o()&&"object"==typeof a&&(sessionStorage.multitabs=JSON.stringify(a))},_exist:function(a){if(!a)return!1;var d,b=this,c=b.$element;return d=c.navPanelList.find('a[data-url="'+a.url+'"]'),d.length?d:!1},_getTabPane:function(b){return a("#"+a(b).attr("data-id"))},_getNavTab:function(b){var c=this,d=c.$element,e=a(b).attr("data-id")||a(b).find("a").attr("data-id");return d.navPanelList.find('a[data-id="'+e+'"]:first')},_fixTabPosition:function(b){var c=this,d=c.$element,e=a(b).parent("li"),f=e.outerWidth(!0),g=e.prev().outerWidth(!0),h=e.prev().prev().outerWidth(!0),i=k(e.prevAll()),j=k(e.nextAll()),l=d.navPanel.outerWidth(!0),m=k(d.navPanelList.children("li")),n=0;if(l>m)n=0;else if(l>=g+f+j)for(n=i;l>m-n+g;)e=e.prev(),n-=e.outerWidth();else i+f>l&&(n=i-g-h);n=n>0?n:0,d.navPanelList.animate({marginLeft:0-n+"px"},"fast")},_getHiddenList:function(){var h,i,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=k(b.navPanelList.children("li")),f=[],g=[];if(d>e)return!1;for(h=b.navPanelList.children("li:first"),i=0;i+h.width()<=c;)i+=h.outerWidth(!0),f.push(h),h=h.next();if(e>i)for(h=b.navPanelList.children("li:last"),i=e;i>c+d;)i-=h.outerWidth(!0),g.unshift(h),h=h.prev();return{prevList:f,nextList:g}},_fixTabContentLayout:function(b){var c=a(b);c.is("iframe")?a("body").addClass("full-height-layout"):a("body").removeClass("full-height-layout")},_unsaveConfirm:function(){var a=this,b=a.options;return confirm(b.language.editorUnsave.close)}},a.fn.multitabs=function(b){var g,c=a(this),d=a(document).data("multitabs"),f="object"==typeof b&&b;return d||(g=a.extend(!0,{},a.fn.multitabs.defaults,f,c.data()),g.style="nav-pills"===g.style?"nav-pills":"nav-tabs",d=new e(this,g),a(document).data("multitabs",d)),a(document).data("multitabs")},a.fn.multitabs.defaults={init:[],style:"nav-tabs",fixed:!1,showHash:!1,showClose:!1,content:"info",link:".multitabs","class":"",iframe:!1,layout:"default",navBar:t,ajaxTabPane:r,iframeTabPane:s,language:q,ajaxSuccess:function(a){return a},ajaxError:function(a){return a}}}(jQuery);